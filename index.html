<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>IXL-lite â€¢ Interactive Learning Platform</title>
  <link rel="stylesheet" href="assets/styles.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Static Educational Background -->
  <div class="edu-background">
    <div class="edu-emoji" style="top: 8%; left: 12%;">ğŸ“š</div>
    <div class="edu-emoji" style="top: 15%; right: 18%;">ï¿½</div>
    <div class="edu-emoji" style="top: 25%; left: 75%;">âœï¸</div>
    <div class="edu-emoji" style="top: 35%; left: 8%;">ğŸ”¢</div>
    <div class="edu-emoji" style="top: 45%; right: 12%;">ğŸ“</div>
    <div class="edu-emoji" style="top: 55%; left: 65%;">ğŸ§®</div>
    <div class="edu-emoji" style="top: 65%; left: 20%;">ğŸ“Š</div>
    <div class="edu-emoji" style="top: 75%; right: 25%;">ğŸ¯</div>
    <div class="edu-emoji" style="top: 85%; left: 45%;">â­</div>
    <div class="edu-emoji" style="top: 20%; left: 40%;">ï¿½</div>
    <div class="edu-emoji" style="top: 60%; right: 45%;">ğŸ’¡</div>
    <div class="edu-emoji" style="top: 40%; left: 30%;">ï¿½</div>
  </div>

<div class="topbar">
  <div class="wrap">
    <a class="brand" href="index.html">
      <span class="logo" aria-hidden="true"></span>
      <span>IXL-lite</span>
    </a>

    <!-- Primary subjects (desktop) -->
    <nav class="subjects" aria-label="Subjects">
      <button class="subject-btn" data-subject="math">ğŸ§® Math</button>
      <a class="subject-btn" href="chapters/abacus/Soroban.html">ğŸª„ Abacus</a>
      <a class="subject-btn" href="chapters/chess/bishopEndgame.html">â™Ÿï¸ Chess</a>
      <button class="subject-btn" data-subject="python">ğŸ Python</button>
    </nav>

    <!-- Search (desktop & mobile) -->
    <form class="site-search" role="search" onsubmit="return false;">
      <input id="q" type="search" placeholder="Search topicsâ€¦ (e.g., Grade 7 Integers)" autocomplete="off" />
      <button id="searchBtn" type="button" aria-label="Search">ğŸ”</button>
    </form>

    <!-- Mobile menu toggle -->
    <button class="hamburger" aria-label="Open menu" aria-controls="mobileMenu" aria-expanded="false">â˜°</button>
  </div>

  <!-- Subject submenu (desktop hover/click) -->
  <div class="subject-submenu" id="subjectSubmenu" hidden aria-hidden="true"></div>

  <!-- Mobile drawer -->
  <div id="mobileMenu" class="mobile-drawer" hidden aria-hidden="true">
    <div class="drawer-inner">
      <h3>Subjects</h3>
      <div class="drawer-links">
        <button class="drawer-btn" data-subject="math">ğŸ§® Math</button>
        <a class="drawer-btn" href="chapters/abacus/Soroban.html">ğŸª„ Abacus</a>
        <a class="drawer-btn" href="chapters/chess/bishopEndgame.html">â™Ÿï¸ Chess</a>
        <button class="drawer-btn" data-subject="python">ğŸ Python</button>
      </div>
      <hr />
      <form class="drawer-search" role="search" onsubmit="return false;">
        <input id="q-mobile" type="search" placeholder="Search topicsâ€¦" autocomplete="off" />
        <button id="searchBtn-mobile" type="button">Search</button>
      </form>
    </div>
  </div>
</div>


  <div class="hero">
    <div class="hero-content">
      <h1>ğŸ“ LIVE 1-on-1 Tutoring</h1>
      <p>Call:- 91-8839694312 Whatsapp:- <a href="https://wa.me/918002416363" target="_blank">Whatsapps Now</a></p>
    </div>
  </div>

  <div class="container">
    <aside id="sidebar" class="sidebar"></aside>
    <div id="results" class="grid"></div>
  </div>

  <div class="footer small">
    âœ¨ IXL-lite â€” Colorful, interactive learning platform with visual activities âœ¨
  </div>

  <script src="engine/router.js"></script>
  <script src="assets/nav.js" defer></script>
  <script>
    // Subject navigation interactivity (touch-friendly)
    (function(){
      const submenu = document.getElementById('subjectSubmenu');

      // Progressive Math navigation

      // Unified subject navigation
      function showSubject(subject) {
        const manifest = window.Manifest || [];
        // Math: show grades first
        if(subject === 'math') {
          submenu.innerHTML = `
            <div class="submenu-inner">
              <div class="submenu-title">Math â€” Choose a grade</div>
              <div class="submenu-actions">
                <button class="btn primary" data-grade="grade3">Grade 3</button>
                <button class="btn primary" data-grade="grade7">Grade 7</button>
              </div>
              <div class="submenu-note muted">Select a grade to see its topics.</div>
            </div>`;
          submenu.hidden = false; submenu.setAttribute('aria-hidden','false');
          return;
        }
        // Other subjects: show topics directly
        const topics = manifest.filter(m => {
          const slug = (m.slug||'').toLowerCase();
          const tags = (m.tags||[]).map(t=>String(t).toLowerCase());
          return slug.startsWith(subject) || tags.includes(subject);
        });
        submenu.innerHTML = `
          <div class="submenu-inner">
            <div class="submenu-title">${subject.charAt(0).toUpperCase()+subject.slice(1)} â€” Choose a topic</div>
            <div class="submenu-actions">
              ${topics.length ? topics.map(t => `<a class="btn primary" href="chapters/${t.slug}.html">${t.title}</a>`).join('') : `<span class='muted'>No topics found.</span>`}
            </div>
            <div class="submenu-note muted">Select a topic to start learning.</div>
          </div>`;
        submenu.hidden = false; submenu.setAttribute('aria-hidden','false');
      }

      function showMathTopics(grade){
        const manifest = window.Manifest || [];
        const topics = manifest.filter(m => (m.tags||[]).includes(grade));
        submenu.innerHTML = `
          <div class="submenu-inner">
            <div class="submenu-title">${grade.replace('grade','Grade ')} â€” Choose a topic</div>
            <div class="submenu-actions">
              ${topics.map(t => `<a class="btn primary" href="chapters/${t.slug}.html">${t.title}</a>`).join('')}
            </div>
            <div class="submenu-note muted">Select a topic to start learning.</div>
            <button class="btn ghost" id="backToGrades">â† Back to grades</button>
          </div>`;
        submenu.hidden = false; submenu.setAttribute('aria-hidden','false');
        setTimeout(()=>{
          const backBtn = document.getElementById('backToGrades');
          if(backBtn) backBtn.onclick = ()=>showSubject('math');
        }, 0);
      }

      function hideSubmenu(){ submenu.hidden = true; submenu.setAttribute('aria-hidden','true'); }


      document.addEventListener('click', (e)=>{
        // Subject button click
        const btn = e.target.closest('.subject-btn');
        if(btn){
          const subject = btn.dataset.subject;
          if(subject){ showSubject(subject); return; }
          hideSubmenu(); return;
        }
        // Grade button click (in submenu)
        const gradeBtn = e.target.closest('.btn[data-grade]');
        if(gradeBtn){
          const grade = gradeBtn.dataset.grade;
          showMathTopics(grade);
          return;
        }
      });

      // close submenu when clicking outside or on Escape
      document.addEventListener('click', (e)=>{
        if(!e.target.closest('.subject-submenu') && !e.target.closest('.subject-btn')){
          hideSubmenu();
        }
      });
      document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') hideSubmenu(); });
    })();
  </script>
  <script>
    function render(list){
      const box = document.getElementById('results');
      box.innerHTML = list.map(item => `
        <article class="card">
          <div class="badge">${item.level}</div>
          <h3>${getTopicEmoji(item.slug)} ${item.title}</h3>
          <p class="muted">Grade level: ${getGradeLevel(item.slug)}</p>
          <div class="card-tags">
            ${(item.tags || []).slice(0, 3).map(tag => `<span class="tag">${tag}</span>`).join('')}
          </div>
          <a class="btn primary" href="chapters/${item.slug}.html">ğŸš€ Start Learning</a>
        </article>
      `).join('');
    }
    
    function getTopicEmoji(slug) {
      if (slug.includes('addition')) return 'â•';
      if (slug.includes('multiplication')) return 'âœ–ï¸';
      if (slug.includes('fractions')) return 'ğŸ°';
      if (slug.includes('place_value')) return 'ğŸ—ï¸';
      if (slug.includes('distributive')) return 'ğŸ§®';
      if (slug.includes('integers')) return 'ğŸ¯';
      if (slug.includes('geometry')) return 'ğŸ“';
      if (slug.includes('angles')) return 'ğŸ“';
      if (slug.includes('circles')) return 'â­•';
      return 'ğŸ“';
    }
    
    function getGradeLevel(slug) {
      if (slug.includes('grade3')) return 'Grade 3';
      if (slug.includes('grade7')) return 'Grade 7';
      if (slug.includes('grade9')) return 'Grade 9';
      if (slug.includes('geometry')) return 'High School';
      return 'Elementary';
    }
    
    async function main(){
      const tick = () => new Promise(r => setTimeout(r, 20));
      while(!window.Manifest){ await tick(); }
      render(window.Manifest);
      const q = document.getElementById('q');
      const btn = document.getElementById('searchBtn');
      function doSearch(){
        const term = q.value.toLowerCase().trim();
        const list = window.Manifest.filter(m => 
          m.title.toLowerCase().includes(term) ||
          m.slug.toLowerCase().includes(term) ||
          (m.tags||[]).join(',').toLowerCase().includes(term)
        );
        render(list.length ? list : window.Manifest);
      }
      btn.onclick = doSearch;
      q.onkeydown = (e)=>{ if(e.key==='Enter') doSearch(); };
    }
    main();
  </script>
  <script>
    // Unified filtering for home page grid (subjects, grades, levels, tags, search)
    (function(){
      if(!/\/index\.html?$/.test(location.pathname)) return;
      const state = { subjects: new Set(), grades: new Set(), levels: new Set(), tags: new Set(), query: '' };

      function matchesSubjects(item){
        if(state.subjects.size===0) return true;
        const slug = (item.slug||'');
        const first = (slug.split('/')[0]||'').toLowerCase();
        const tags = (item.tags||[]).map(t=>String(t).toLowerCase());
        const hasMath = /^grade\d+$/i.test(first) || tags.some(t=>/^grade\d+$/i.test(t));
        for(const s of state.subjects){
          if(s==='math' && hasMath) return true;
          if(first===s.toLowerCase() || tags.includes(s.toLowerCase())) return true;
        }
        return false;
      }
      function matchesGrades(item){
        if(state.grades.size===0) return true;
        const slug = (item.slug||'').toLowerCase();
        const tags = (item.tags||[]).map(t=>String(t).toLowerCase());
        for(const g of state.grades){ if(slug.includes(g.toLowerCase()) || tags.includes(g.toLowerCase())) return true; }
        return false;
      }
      function matchesLevels(item){ if(state.levels.size===0) return true; return state.levels.has(String(item.level||'').toLowerCase()); }
      function matchesTags(item){ if(state.tags.size===0) return true; const tags=(item.tags||[]).map(t=>String(t).toLowerCase()); for(const t of state.tags){ if(tags.includes(t)) return true; } return false; }
      function matchesQuery(item){ const q=(state.query||'').trim().toLowerCase(); if(!q) return true; return (item.title||'').toLowerCase().includes(q) || (item.slug||'').toLowerCase().includes(q) || (item.tags||[]).join(',').toLowerCase().includes(q); }
      function applyFilters(){ if(!window.Manifest || typeof render !== 'function') return; const list = window.Manifest.filter(it => matchesSubjects(it) && matchesGrades(it) && matchesLevels(it) && matchesTags(it) && matchesQuery(it)); render(list); }

      // Override search to use unified filtering
      const q = document.getElementById('q');
      const btn = document.getElementById('searchBtn');
      if(btn){ btn.onclick = ()=>{ state.query = (q && q.value || '').trim().toLowerCase(); applyFilters(); }; }
      if(q){ q.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); state.query = (q.value||'').trim().toLowerCase(); applyFilters(); } }); }

      // Listen to nav.js events and sidebar filter changes
      document.addEventListener('ixl:subject', (ev)=>{ state.subjects = new Set([ev.detail && ev.detail.subject].filter(Boolean)); state.grades = new Set(); applyFilters(); });
      document.addEventListener('ixl:grade', (ev)=>{ state.subjects = new Set(['math']); state.grades = new Set([ev.detail && ev.detail.grade].filter(Boolean)); applyFilters(); });
      document.addEventListener('ixl:search', (ev)=>{ state.query = (ev.detail && ev.detail.q || '').toLowerCase(); applyFilters(); });
      document.addEventListener('ixl:filters', (ev)=>{ const d = ev.detail || {}; state.subjects = new Set(d.subjects||[]); state.grades = new Set(d.grades||[]); state.levels = new Set((d.levels||[]).map(x=>String(x).toLowerCase())); state.tags = new Set((d.tags||[]).map(x=>String(x).toLowerCase())); applyFilters(); });

      // Read initial hash (e.g., #grade7 or #geometry) to seed filters
      (function seedFromHash(){
        const h = (location.hash||'').replace(/^#/,'').toLowerCase();
        if(!h) return;
        if(/^grade\d+$/.test(h)){ state.subjects = new Set(['math']); state.grades = new Set([h]); }
        else { state.subjects = new Set([h]); }
        applyFilters();
      })();
    })();
  </script>
</body>
</html>
  <script>
    (function(){
      const parts = location.pathname.split('/').filter(Boolean);
      const depth = Math.max(0, parts.length - 1);
      const prefix = '../'.repeat(depth);
      const s = document.createElement('script');
      s.src = prefix + 'assets/global-nav.js';
      s.defer = true;
      document.body.appendChild(s);
    })();
  </script>
