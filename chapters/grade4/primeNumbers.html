<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prime Sieve Playground</title>
  <style>
    :root {
      --midnight: #1d1f3b;
      --aqua: #4be3ff;
      --lime: #8df27f;
      --magenta: #ff6fd8;
      --sunny: #ffd966;
      --sky: #62a4ff;
      --peach: #ffb26b;
      --bg: radial-gradient(circle at top, #3d2df5 0%, #2b1c6f 28%, #140b33 70%);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Nunito', 'Poppins', sans-serif;
      background: var(--bg);
      color: #fff;
      min-height: 100vh;
      padding: 30px 20px 80px;
    }

    h1, h2, h3 {
      margin: 0;
      font-weight: 800;
      letter-spacing: 0.5px;
    }

    p {
      margin: 0;
    }

    .playground-shell {
      max-width: 1200px;
      margin: 0 auto;
      background: rgba(20, 11, 51, 0.92);
      border-radius: 36px;
      padding: 32px;
      box-shadow: 0 30px 60px rgba(0, 0, 0, 0.45);
      border: 3px solid rgba(255, 255, 255, 0.08);
      position: relative;
      overflow: hidden;
    }

    .sparkle {
      position: absolute;
      width: 120px;
      height: 120px;
      background: rgba(255, 255, 255, 0.08);
      border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
      filter: blur(8px);
      animation: float 6s ease-in-out infinite alternate;
      pointer-events: none;
    }

    .sparkle.one {
      top: -20px;
      right: 60px;
    }

    .sparkle.two {
      bottom: -40px;
      left: 30px;
      animation-duration: 8s;
    }

    @keyframes float {
      to {
        transform: translateY(30px) scale(1.1);
      }
    }

    header {
      text-align: center;
      margin-bottom: 28px;
      position: relative;
      z-index: 1;
    }

    header h1 {
      font-size: 3rem;
      color: var(--sunny);
      text-shadow: 0 8px 25px rgba(0, 0, 0, 0.6);
    }

    .subheading {
      font-size: 1.1rem;
      margin-top: 8px;
      color: rgba(255, 255, 255, 0.86);
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 18px;
      align-items: center;
      justify-content: center;
      margin-bottom: 24px;
    }

    .mode-btn {
      border: none;
      padding: 14px 24px;
      border-radius: 999px;
      font-size: 1rem;
      font-weight: 700;
      color: #13092f;
      background: var(--sunny);
      cursor: pointer;
      transition: transform 0.15s ease, box-shadow 0.15s ease;
      box-shadow: 0 12px 25px rgba(255, 217, 102, 0.35);
    }

    .mode-btn[data-mode="multiples"] {
      background: var(--aqua);
      box-shadow: 0 12px 25px rgba(75, 227, 255, 0.3);
    }

    .mode-btn[data-mode="factors"] {
      background: var(--magenta);
      box-shadow: 0 12px 25px rgba(255, 111, 216, 0.35);
    }

    .mode-btn.active {
      transform: translateY(-4px);
      outline: 3px solid rgba(255, 255, 255, 0.65);
    }

    .mode-description {
      text-align: center;
      font-size: 1.05rem;
      color: rgba(255, 255, 255, 0.85);
      margin-bottom: 22px;
    }

    .status-board {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      margin-bottom: 24px;
    }

    .status-card {
      flex: 1;
      min-width: 220px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 24px;
      padding: 18px;
      border: 2px solid rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(6px);
    }

    .status-card h3 {
      font-size: 1.1rem;
      color: var(--aqua);
      margin-bottom: 6px;
    }

    .status-card p {
      font-size: 1.4rem;
      font-weight: 800;
      color: #fff;
    }

    .number-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(58px, 1fr));
      gap: 10px;
      background: rgba(8, 4, 23, 0.65);
      padding: 20px;
      border-radius: 26px;
      border: 2px solid rgba(255, 255, 255, 0.05);
      min-height: 420px;
    }

    .number-cell {
      position: relative;
      border: none;
      padding: 12px 8px;
      border-radius: 18px;
      font-size: 1rem;
      font-weight: 700;
      color: #120b2d;
      background: #feeefe;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
      min-height: 52px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .number-cell:hover {
      transform: translateY(-4px);
    }

    .number-cell.selected {
      background: var(--sunny);
      transform: translateY(-5px) scale(1.05);
    }

    .number-cell.related {
      background: var(--aqua);
      color: #0b1331;
      animation: shimmer 0.8s linear infinite;
    }

    .number-cell.crossed {
      background: #ff99a8;
      color: #4d1222;
    }

    .number-cell.crossed::after {
      content: "";
      position: absolute;
      width: 80%;
      height: 3px;
      background: #80213e;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) rotate(-18deg);
      border-radius: 999px;
      animation: strike 0.25s ease forwards;
    }

    .number-cell.factor {
      background: var(--lime);
      color: #043412;
      box-shadow: 0 0 12px rgba(141, 242, 127, 0.6);
    }

    .number-cell.prime-hint::before {
      content: "â˜…";
      position: absolute;
      font-size: 0.7rem;
      top: 6px;
      left: 8px;
      color: #ff499e;
      opacity: 0.75;
    }

    .number-cell.quiz-correct {
      border: 3px solid #00ffa3;
      animation: pop 0.45s ease;
    }

    .number-cell.quiz-wrong {
      border: 3px solid #ff3569;
      animation: shake 0.4s ease;
    }

    @keyframes strike {
      from { width: 0; opacity: 0; }
      to { width: 80%; opacity: 1; }
    }

    @keyframes shimmer {
      0% { box-shadow: 0 0 0 rgba(75, 227, 255, 0.2); }
      50% { box-shadow: 0 0 15px rgba(75, 227, 255, 0.8); }
      100% { box-shadow: 0 0 0 rgba(75, 227, 255, 0.2); }
    }

    @keyframes pop {
      0% { transform: scale(0.7); }
      70% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-4px); }
      50% { transform: translateX(4px); }
      75% { transform: translateX(-2px); }
    }

    .quiz-panel {
      margin-top: 32px;
      background: rgba(255, 255, 255, 0.08);
      border-radius: 28px;
      padding: 24px;
      border: 2px solid rgba(255, 255, 255, 0.12);
    }

    .quiz-panel h2 {
      font-size: 1.8rem;
      color: var(--lime);
      margin-bottom: 8px;
    }

    .quiz-panel p {
      color: rgba(255, 255, 255, 0.85);
      margin-bottom: 18px;
    }

    .quiz-stats {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      margin-bottom: 18px;
    }

    .quiz-stat {
      flex: 1;
      min-width: 140px;
      background: rgba(0, 0, 0, 0.35);
      border-radius: 18px;
      padding: 12px 18px;
    }

    .quiz-stat span {
      display: block;
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.65);
    }

    .quiz-stat strong {
      font-size: 1.5rem;
      display: block;
      margin-top: 6px;
    }

    #start-quiz {
      border: none;
      background: var(--sky);
      color: #041033;
      border-radius: 999px;
      padding: 14px 26px;
      font-size: 1.05rem;
      font-weight: 800;
      cursor: pointer;
      box-shadow: 0 12px 24px rgba(98, 164, 255, 0.4);
      transition: transform 0.2s ease;
    }

    #start-quiz:hover {
      transform: translateY(-3px);
    }

    #quiz-message {
      margin-top: 16px;
      font-size: 1.1rem;
      min-height: 26px;
    }

    .celebration-layer {
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
    }

    .celebration-piece {
      position: absolute;
      width: 12px;
      height: 26px;
      border-radius: 8px;
      opacity: 0;
      animation: confetti 1.8s ease-out forwards;
    }

    @keyframes confetti {
      0% {
        opacity: 1;
        transform: translateY(-10vh) rotate(0deg);
      }
      100% {
        opacity: 0;
        transform: translateY(90vh) rotate(360deg);
      }
    }

    @media (max-width: 768px) {
      body {
        padding: 16px;
      }

      .playground-shell {
        padding: 20px;
      }

      header h1 {
        font-size: 2.2rem;
      }

      .number-grid {
        grid-template-columns: repeat(auto-fill, minmax(48px, 1fr));
        padding: 14px;
      }

      .number-cell {
        min-height: 46px;
      }
    }
  </style>
</head>
<body>
  <div class="playground-shell">
    <div class="sparkle one"></div>
    <div class="sparkle two"></div>

    <header>
      <h1>Prime Sieve Playground</h1>
      <p class="subheading">Click a number, sweep away multiples, and become a prime detective!</p>
    </header>

    <section class="controls">
      <button class="mode-btn active" data-mode="prime">Find Prime Numbers</button>
      <button class="mode-btn" data-mode="multiples">Find Multiples</button>
      <button class="mode-btn" data-mode="factors">Find Factors</button>
    </section>

    <div class="mode-description" id="mode-description">
      Tap a starting number to cross out its multiples. Watch the sieve reveal primes!
    </div>

    <section class="status-board">
      <div class="status-card">
        <h3>Selected Number</h3>
        <p id="selected-number">None</p>
      </div>
      <div class="status-card">
        <h3>Mode Insight</h3>
        <p id="mode-insight">Choose a mode and tap a number to explore.</p>
      </div>
    </section>

    <section class="grid-section">
      <div class="number-grid" id="number-grid" aria-label="Numbers 1 through 200"></div>
    </section>

    <section class="quiz-panel">
      <h2>Prime Sieve Quiz Blitz</h2>
      <p>Click all prime numbers between 50 and 100 before the slime timer runs out.</p>
      <div class="quiz-stats">
        <div class="quiz-stat">
          <span>Score</span>
          <strong id="quiz-score">0</strong>
        </div>
        <div class="quiz-stat">
          <span>Timer</span>
          <strong id="quiz-timer">--</strong>
        </div>
        <div class="quiz-stat">
          <span>Primes to find</span>
          <strong>10</strong>
        </div>
      </div>
      <button id="start-quiz">Start Quiz</button>
      <div id="quiz-message"></div>
    </section>
  </div>

  <div class="celebration-layer" id="celebration-layer"></div>

  <script>
    const grid = document.getElementById('number-grid');
    const selectedNumberDisplay = document.getElementById('selected-number');
    const modeInsight = document.getElementById('mode-insight');
    const modeDescription = document.getElementById('mode-description');
    const celebrationLayer = document.getElementById('celebration-layer');

    const modeButtons = [...document.querySelectorAll('.mode-btn')];
    const modeDescriptions = {
      prime: 'Tap a starting number to cross out its multiples. Watch the sieve reveal primes!',
      multiples: 'Tap a number to light up every multiple it has up to 200.',
      factors: 'Tap a number to highlight every factor hiding inside it.'
    };

    let activeMode = 'prime';
    const limit = 200;
    const numberCells = [];

    const primeList = generatePrimes(limit);
    const primeSet = new Set(primeList);

    // Quiz data
    const quizPrimeNumbers = [53, 59, 61, 67, 71, 73, 79, 83, 89, 97];
    const quizPrimeSet = new Set(quizPrimeNumbers);
    let quizActive = false;
    let quizScore = 0;
    let quizTimerId = null;
    let timeLeft = 40;
    const foundQuizPrimes = new Set();
    const quizScoreDisplay = document.getElementById('quiz-score');
    const quizTimerDisplay = document.getElementById('quiz-timer');
    const quizMessage = document.getElementById('quiz-message');
    const startQuizBtn = document.getElementById('start-quiz');

    // Build grid
    for (let i = 1; i <= limit; i++) {
      const cell = document.createElement('button');
      cell.type = 'button';
      cell.className = 'number-cell';
      cell.textContent = i;
      cell.dataset.value = i;
      if (primeSet.has(i)) {
        cell.classList.add('prime-hint');
      }
      cell.addEventListener('click', () => handleNumberClick(i, cell));
      grid.appendChild(cell);
      numberCells.push(cell);
    }

    modeButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const newMode = btn.dataset.mode;
        if (newMode === activeMode) return;
        activeMode = newMode;
        modeButtons.forEach(b => b.classList.toggle('active', b === btn));
        modeDescription.textContent = modeDescriptions[activeMode];
        modeInsight.textContent = 'Mode switched! Tap a number to see what happens.';
        clearHighlights();
      });
    });

    function handleNumberClick(number, cell) {
      selectedNumberDisplay.textContent = number;
      clearHighlights();
      cell.classList.add('selected');

      if (activeMode === 'prime') {
        runPrimeMode(number);
      } else if (activeMode === 'multiples') {
        runMultiplesMode(number);
      } else {
        runFactorsMode(number);
      }

      if (quizActive) {
        handleQuizClick(number, cell);
      }
    }

    function runPrimeMode(number) {
      if (number < 2) {
        modeInsight.textContent = 'Start with 2 or above. Ones never help in prime sieves!';
        return;
      }
      let crossCount = 0;
      for (let multiple = number * 2; multiple <= limit; multiple += number) {
        const targetCell = numberCells[multiple - 1];
        targetCell.classList.add('crossed', 'related');
        crossCount++;
      }
      modeInsight.textContent = crossCount === 0
        ? 'No multiples left to cross! This number might be prime.'
        : `Crossed out ${crossCount} multiples of ${number}.`;
    }

    function runMultiplesMode(number) {
      let hits = 0;
      for (let multiple = number; multiple <= limit; multiple += number) {
        const targetCell = numberCells[multiple - 1];
        targetCell.classList.add('related');
        hits++;
      }
      modeInsight.textContent = `There are ${hits} multiples of ${number} from 1 to ${limit}.`;
    }

    function runFactorsMode(number) {
      let factors = [];
      for (let suspect = 1; suspect <= number; suspect++) {
        if (number % suspect === 0) {
          const targetCell = numberCells[suspect - 1];
          targetCell.classList.add('factor');
          factors.push(suspect);
        }
      }
      modeInsight.textContent = `${number} has ${factors.length} factors: ${factors.join(', ')}.`;
    }

    function clearHighlights() {
      numberCells.forEach(cell => {
        cell.classList.remove('selected', 'related', 'crossed', 'factor');
      });
    }

    function generatePrimes(max) {
      const sieve = Array(max + 1).fill(true);
      sieve[0] = sieve[1] = false;
      for (let i = 2; i * i <= max; i++) {
        if (sieve[i]) {
          for (let j = i * i; j <= max; j += i) {
            sieve[j] = false;
          }
        }
      }
      const primes = [];
      sieve.forEach((isPrime, index) => {
        if (isPrime) primes.push(index);
      });
      return primes;
    }

    // Quiz logic
    startQuizBtn.addEventListener('click', startQuiz);

    function startQuiz() {
      quizActive = true;
      foundQuizPrimes.clear();
      quizScore = 0;
      timeLeft = 40;
      updateQuizDisplays();
      quizMessage.textContent = 'Timer started! Click every prime from 50 to 100.';

      numberCells.forEach(cell => cell.classList.remove('quiz-correct', 'quiz-wrong'));

      clearInterval(quizTimerId);
      quizTimerId = setInterval(() => {
        timeLeft--;
        updateQuizDisplays();
        if (timeLeft <= 0) {
          endQuiz(false);
        }
      }, 1000);
    }

    function handleQuizClick(number, cell) {
      if (number < 50 || number > 100) return;
      if (foundQuizPrimes.has(number)) return;

      if (quizPrimeSet.has(number)) {
        foundQuizPrimes.add(number);
        quizScore += 5;
        cell.classList.add('quiz-correct');
        quizMessage.textContent = `Great! ${number} is prime. ${quizPrimeSet.size - foundQuizPrimes.size} left.`;

        if (foundQuizPrimes.size === quizPrimeSet.size) {
          endQuiz(true);
        }
      } else {
        quizScore = Math.max(0, quizScore - 2);
        cell.classList.add('quiz-wrong');
        quizMessage.textContent = `${number} is not prime. Try again!`;
        setTimeout(() => cell.classList.remove('quiz-wrong'), 800);
      }
      updateQuizDisplays();
    }

    function endQuiz(won) {
      if (!quizActive) return;
      quizActive = false;
      clearInterval(quizTimerId);
      quizTimerDisplay.textContent = won ? 'YAY!' : '0';
      if (won) {
        quizMessage.textContent = 'All primes found! You rocked the sieve! ðŸŽ‰';
        launchCelebration();
      } else {
        quizMessage.textContent = 'Time ran out! Try chasing those primes again.';
      }
    }

    function updateQuizDisplays() {
      quizScoreDisplay.textContent = quizScore;
      quizTimerDisplay.textContent = quizActive ? `${timeLeft}s` : '--';
    }

    function launchCelebration() {
      for (let i = 0; i < 28; i++) {
        const piece = document.createElement('span');
        piece.className = 'celebration-piece';
        piece.style.left = `${Math.random() * 100}%`;
        piece.style.background = [varColor('--sunny'), varColor('--aqua'), varColor('--magenta'), varColor('--lime'), varColor('--peach')][Math.floor(Math.random() * 5)];
        piece.style.animationDuration = `${1.2 + Math.random()}s`;
        piece.style.transform = `rotate(${Math.random() * 360}deg)`;
        celebrationLayer.appendChild(piece);
        setTimeout(() => piece.remove(), 1800);
      }
    }

    function varColor(name) {
      return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
    }
  </script>
</body>
</html>
