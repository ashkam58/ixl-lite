<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Satvik's Prime Adventure</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Style for highlighted prime numbers */
        .prime-highlight {
            background-color: #FBBF24; /* Tailwind yellow-500 */
            color: #1F2937; /* Tailwind gray-800 */
            transform: scale(1.1);
            border-width: 2px;
            border-color: #FDE68A; /* Tailwind yellow-200 */
        }
        /* Style for correctly guessed primes in quiz */
        .prime-correct {
            background-color: #10B981; /* Tailwind green-500 */
            color: white;
            transform: scale(1.1);
        }
        /* Style for incorrectly guessed numbers in quiz */
        .prime-wrong {
            background-color: #EF4444; /* Tailwind red-500 */
            color: white;
            opacity: 0.7;
        }
        /* Style for missed primes in quiz */
        .prime-missed {
            background-color: #FBBF24; /* Tailwind yellow-500 */
            opacity: 0.6;
            border: 2px dashed #B45309; /* Tailwind yellow-700 */
        }
        /* Simple transition for all grid items */
        .number-cell {
            transition: all 0.2s ease-in-out;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-900 to-purple-900 text-white min-h-screen p-4 md:p-8">

    <div class="max-w-4xl mx-auto">

        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-yellow-300">
                Satvik's Prime Adventure!
            </h1>
            <p class="text-indigo-200 text-lg mt-2">Learn Primes & Master Factorization</p>
        </header>

        <!-- Navigation -->
        <nav class="flex justify-center gap-4 mb-8">
            <button onclick="showView('homeView')" class="nav-button bg-pink-500 hover:bg-pink-600 text-white font-bold py-2 px-6 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">Home</button>
            <button onclick="showView('learnView')" class="nav-button bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">Learn Primes</button>
            <button onclick="showView('factorView')" class="nav-button bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105">Factor Practice</button>
        </nav>

        <!-- Main Content Area -->
        <main id="main-content">

            <!-- View 1: Home Screen -->
            <div id="homeView" class="app-view text-center bg-white/10 p-8 rounded-2xl shadow-xl backdrop-blur-md">
                <h2 class="text-3xl font-bold text-yellow-300 mb-4">Welcome, Satvik!</h2>
                <p class="text-xl text-indigo-100 mb-8">
                    Let's go on an adventure to learn all about prime numbers.
                </p>
                <div class="flex flex-col md:flex-row justify-center gap-6">
                    <button onclick="showView('learnView')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-8 rounded-lg text-lg shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-1">
                        ðŸš€ Start Learning Primes
                    </button>
                    <button onclick="showView('factorView')" class="bg-green-500 hover:bg-green-600 text-white font-bold py-4 px-8 rounded-lg text-lg shadow-lg transition duration-300 ease-in-out transform hover:-translate-y-1">
                        ðŸ§© Practice Prime Factorization
                    </button>
                </div>
            </div>

            <!-- View 2: Learn Primes -->
            <div id="learnView" class="app-view hidden bg-white/10 p-6 md:p-8 rounded-2xl shadow-xl backdrop-blur-md">
                <h2 class="text-3xl font-bold text-yellow-300 mb-6 text-center">Prime Number Grid (1-100)</h2>
                
                <!-- Controls for Learn View -->
                <div class="flex flex-wrap justify-center gap-4 mb-6">
                    <button id="togglePrimesBtn" onclick="togglePrimes()" class="bg-yellow-500 hover:bg-yellow-600 text-gray-900 font-bold py-2 px-5 rounded-full shadow-md transition duration-300">Show/Hide All Primes</button>
                    <button id="startQuizBtn" onclick="startPrimeQuiz()" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-2 px-5 rounded-full shadow-md transition duration-300">Start Practice Quiz</button>
                    <button id="showAnswersBtn" onclick="showQuizAnswers()" class="hidden bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-5 rounded-full shadow-md transition duration-300">Show Answers</button>
                    <button id="resetGridBtn" onclick="resetGrid()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-5 rounded-full shadow-md transition duration-300">Reset Grid</button>
                </div>

                <!-- Quiz Score Area -->
                <div id="quizScoreArea" class="text-center mb-4 hidden">
                    <p class="text-2xl font-bold">Score: <span id="quizScore" class="text-yellow-300">0</span> / 25</p>
                    <p id="quizMessage" class="text-lg text-indigo-200 h-6"></p>
                </div>

                <!-- 1-100 Grid -->
                <div id="primeGrid" class="grid grid-cols-10 gap-2 md:gap-3">
                    <!-- Numbers 1-100 will be generated by JS -->
                </div>
            </div>

            <!-- View 3: Practice Factorization -->
            <div id="factorView" class="app-view hidden bg-white/10 p-6 md:p-8 rounded-2xl shadow-xl backdrop-blur-md">
                <h2 class="text-3xl font-bold text-yellow-300 mb-6 text-center">Prime Factorization Practice</h2>
                
                <div class="bg-indigo-800 p-8 rounded-xl shadow-inner text-center">
                    <p class="text-lg text-indigo-200 mb-4">Find all the prime factors of this number:</p>
                    <h3 id="factorNumber" class="text-7xl font-bold text-yellow-300 mb-6">60</h3>
                    
                    <p class="text-indigo-200 mb-2">Type the prime factors, separated by a comma or star (e.g., 2, 5, 5)</p>
                    <input id="factorInput" type="text" class="text-center text-2xl font-bold text-gray-900 w-full max-w-sm p-3 rounded-lg shadow-md border-4 border-transparent focus:border-yellow-400 focus:outline-none" placeholder="e.g. 2, 3, 3">
                    
                    <div class="flex flex-wrap justify-center gap-4 mt-6">
                        <button onclick="checkFactorAnswer()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-full text-lg shadow-lg transition duration-300 transform hover:scale-105">Check Answer</button>
                        <button onclick="generateFactorProblem()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-full text-lg shadow-lg transition duration-300 transform hover:scale-105">New Number</button>
                    </div>
                </div>

                <!-- Message area for factorization -->
                <div id="factorMessage" class="text-center text-2xl font-bold mt-6 h-10">
                    <!-- Feedback appears here -->
                </div>

            </div>

        </main>

    </div>

    <script>
        // --- Global State and Constants ---
        const primesList = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97];
        const primeGrid = document.getElementById('primeGrid');
        const views = document.querySelectorAll('.app-view');
        
        // Navigation buttons
        const navButtons = document.querySelectorAll('.nav-button');

        // Learn Primes state
        let quizModeActive = false;
        let quizScore = 0;
        let guessedPrimes = new Set();
        
        // Factorization state
        let currentFactorProblem = { number: 0, factors: [] };

        // --- Utility Functions ---

        /**
         * Hides all views and shows the one with the specified ID.
         * Also updates the active state of navigation buttons.
         * @param {string} viewId - The ID of the view to show.
         */
        function showView(viewId) {
            views.forEach(view => {
                if (view.id === viewId) {
                    view.classList.remove('hidden');
                } else {
                    view.classList.add('hidden');
                }
            });

            // Update nav button active state
            navButtons.forEach(button => {
                if (button.onclick.toString().includes(viewId)) {
                    button.classList.add('ring-4', 'ring-yellow-300');
                } else {
                    button.classList.remove('ring-4', 'ring-yellow-300');
                }
            });

            // Initialize views when shown
            if (viewId === 'learnView') {
                resetGrid();
            } else if (viewId === 'factorView') {
                generateFactorProblem();
            } else if (viewId === 'homeView') {
                // Set home button as active
                navButtons[0].classList.add('ring-4', 'ring-yellow-300');
            }
        }

        /**
         * Checks if a number is prime (up to 100).
         * @param {number} num - The number to check.
         * @returns {boolean} - True if the number is in the primesList.
         */
        function isPrime(num) {
            return primesList.includes(num);
        }

        // --- Learn Primes (View 2) Functions ---

        /**
         * Populates the 1-100 grid with number cells.
         */
        function generatePrimeGrid() {
            primeGrid.innerHTML = ''; // Clear existing grid
            for (let i = 1; i <= 100; i++) {
                const cell = document.createElement('div');
                cell.textContent = i;
                cell.dataset.number = i;
                cell.className = 'number-cell cursor-pointer flex items-center justify-center h-12 md:h-16 bg-white/10 hover:bg-white/20 rounded-lg text-lg md:text-xl font-bold shadow-md';
                
                // Add click listener for quiz mode
                cell.addEventListener('click', () => handleGridClick(i, cell));
                
                // Special case for 1 (neither prime nor composite)
                if (i === 1) {
                    cell.classList.add('opacity-50', 'cursor-not-allowed');
                }
                
                primeGrid.appendChild(cell);
            }
        }

        /**
         * Handles clicks on the grid cells.
         * Behavior changes based on whether quiz mode is active.
         * @param {number} num - The number of the clicked cell.
         * @param {HTMLElement} cell - The clicked cell element.
         */
        function handleGridClick(num, cell) {
            if (num === 1) return; // Ignore clicks on 1

            if (quizModeActive) {
                // --- Quiz Mode Logic ---
                if (cell.classList.contains('prime-correct') || cell.classList.contains('prime-wrong')) {
                    return; // Already guessed
                }

                const quizMessage = document.getElementById('quizMessage');
                if (isPrime(num)) {
                    cell.classList.add('prime-correct');
                    quizScore++;
                    guessedPrimes.add(num);
                    document.getElementById('quizScore').textContent = quizScore;
                    quizMessage.textContent = "Correct! " + num + " is prime.";
                    quizMessage.className = 'text-lg text-green-400 h-6';

                    // Check for win
                    if (quizScore === primesList.length) {
                        quizMessage.textContent = "Wow! You found all 25 primes! ðŸŽ‰";
                        quizMessage.className = 'text-lg text-yellow-300 h-6';
                        endPrimeQuiz();
                    }
                } else {
                    cell.classList.add('prime-wrong');
                    quizMessage.textContent = "Oops! " + num + " is not prime.";
                    quizMessage.className = 'text-lg text-red-400 h-6';
                }
            } else {
                // --- Learning Mode Logic ---
                // Toggle a single cell's highlight
                if (isPrime(num)) {
                    cell.classList.toggle('prime-highlight');
                }
            }
        }

        /**
         * Toggles the 'prime-highlight' class on all prime number cells.
         */
        function togglePrimes() {
            if (quizModeActive) return; // Don't allow this in quiz mode
            const cells = primeGrid.querySelectorAll('.number-cell');
            cells.forEach(cell => {
                const num = parseInt(cell.dataset.number);
                if (isPrime(num)) {
                    cell.classList.toggle('prime-highlight');
                }
            });
        }

        /**
         * Resets the grid to its initial state.
         */
        function resetGrid() {
            quizModeActive = false;
            quizScore = 0;
            guessedPrimes.clear();
            
            generatePrimeGrid(); // Re-creates the grid and listeners

            // Hide quiz elements
            document.getElementById('quizScoreArea').classList.add('hidden');
            document.getElementById('showAnswersBtn').classList.add('hidden');
            document.getElementById('quizMessage').textContent = '';
            
            // Show non-quiz buttons
            document.getElementById('togglePrimesBtn').classList.remove('hidden');
            document.getElementById('startQuizBtn').classList.remove('hidden');
            document.getElementById('startQuizBtn').disabled = false;
            document.getElementById('togglePrimesBtn').disabled = false;
        }

        /**
         * Starts the prime number practice quiz.
         */
        function startPrimeQuiz() {
            resetGrid(); // Start with a clean grid
            quizModeActive = true;
            
            // Show quiz elements
            document.getElementById('quizScoreArea').classList.remove('hidden');
            document.getElementById('showAnswersBtn').classList.remove('hidden');
            document.getElementById('quizScore').textContent = '0';
            document.getElementById('quizMessage').textContent = 'Click all the prime numbers!';
            document.getElementById('quizMessage').className = 'text-lg text-indigo-200 h-6';
            
            // Hide non-quiz buttons
            document.getElementById('togglePrimesBtn').classList.add('hidden');
            
            // Disable start button
            document.getElementById('startQuizBtn').disabled = true;
        }

        /**
         * Ends the prime quiz and shows the results.
         */
        function showQuizAnswers() {
            if (!quizModeActive) return;
            endPrimeQuiz();
            
            const cells = primeGrid.querySelectorAll('.number-cell');
            let missedCount = 0;

            cells.forEach(cell => {
                const num = parseInt(cell.dataset.number);
                if (isPrime(num)) {
                    if (!guessedPrimes.has(num)) {
                        // This prime was missed
                        cell.classList.add('prime-missed');
                        missedCount++;
                    }
                } else if (!cell.classList.contains('prime-wrong')) {
                    // Dim non-primes that weren't clicked
                    cell.classList.add('opacity-30');
                }
            });
            
            const quizMessage = document.getElementById('quizMessage');
            if (missedCount > 0) {
                quizMessage.textContent = `You found ${quizScore} and missed ${missedCount}. The missed ones are highlighted in yellow.`;
                quizMessage.className = 'text-lg text-yellow-300 h-6';
            } else if (quizScore === primesList.length) {
                quizMessage.textContent = "Perfect score! You found all 25 primes! ðŸŽ‰";
                quizMessage.className = 'text-lg text-yellow-300 h-6';
            } else {
                 quizMessage.textContent = `Great job! You found all ${quizScore} primes you clicked on.`;
                 quizMessage.className = 'text-lg text-green-400 h-6';
            }
        }
        
        /**
         * Helper function to disable quiz functionality.
         */
        function endPrimeQuiz() {
            quizModeActive = false;
            document.getElementById('startQuizBtn').disabled = false;
            document.getElementById('showAnswersBtn').classList.add('hidden');
        }


        // --- Practice Factorization (View 3) Functions ---

        /**
         * Calculates the prime factors of a given number.
         * @param {number} n - The number to factorize.
         * @returns {number[]} - An array of prime factors.
         */
        function getPrimeFactors(n) {
            const factors = [];
            let d = 2;
            let num = n;

            while (d * d <= num) {
                if (num % d === 0) {
                    factors.push(d);
                    num /= d;
                } else {
                    d++;
                }
            }
            if (num > 1) {
                factors.push(num);
            }
            return factors.sort((a, b) => a - b);
        }

        /**
         * Generates a new prime factorization problem.
         */
        function generateFactorProblem() {
            let num = 0;
            // Keep picking a number until it's composite
            do {
                num = Math.floor(Math.random() * 97) + 4; // Random number from 4 to 100
            } while (isPrime(num));

            currentFactorProblem.number = num;
            currentFactorProblem.factors = getPrimeFactors(num);

            document.getElementById('factorNumber').textContent = num;
            document.getElementById('factorInput').value = '';
            document.getElementById('factorMessage').textContent = '';
        }

        /**
         * Checks the user's factorization answer.
         */
        function checkFactorAnswer() {
            const input = document.getElementById('factorInput').value;
            const messageEl = document.getElementById('factorMessage');

            if (input.trim() === '') {
                messageEl.textContent = "Please enter some factors!";
                messageEl.className = 'text-center text-2xl font-bold mt-6 h-10 text-yellow-400';
                return;
            }

            // Parse user input (handles commas, stars, and spaces)
            const userFactors = input
                .split(/[,* ]+/)
                .filter(n => n.trim() !== '') // Remove empty strings
                .map(n => parseInt(n))
                .filter(n => !isNaN(n)); // Remove non-numeric entries

            // Sort for comparison
            userFactors.sort((a, b) => a - b);

            // Convert arrays to strings for easy comparison
            const userFactorsString = JSON.stringify(userFactors);
            const correctFactorsString = JSON.stringify(currentFactorProblem.factors);

            if (userFactorsString === correctFactorsString) {
                messageEl.textContent = "Correct! ðŸŽ‰";
                messageEl.className = 'text-center text-2xl font-bold mt-6 h-10 text-green-400';
                // Load a new problem after a short delay
                setTimeout(generateFactorProblem, 1500);
            } else {
                messageEl.textContent = "Not quite. Try again!";
                messageEl.className = 'text-center text-2xl font-bold mt-6 h-10 text-red-400';
            }
        }

        // --- Initialization ---
        
        /**
         * Runs when the page loads.
         */
        window.onload = () => {
            generatePrimeGrid();
            generateFactorProblem();
            showView('homeView'); // Start on the home screen
        };

    </script>
</body>
</html>